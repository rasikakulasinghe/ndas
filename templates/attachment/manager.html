{% extends 'src/base.html' %}
{% block title %}Attachment Manager{% endblock title%}

{% block main_content %}
<div class="container">

</br>

{% if attachment_page_obj %}

{{attachment_page_obj.User.id}}

  <div class="card">
    <div class="card-header bg-info">
    <h3 class="card-title">Attachment Manager</h3>
    </div>

    <table class="table table-hover text-nowrap">
    <thead>
    <tr>
    <th>Index</th>
    <th>Type</th>
    <th>Title</th>
    <th>Patient Name</th>
    <th>Description</th>
    <th>Created</th>
    <th>Action</th>
    </tr>
    </thead>
    <tbody>

    {% for Attachment in attachment_page_obj %}
    <tr>
      <td>{{ Attachment.id }}</td>
      <td>{% if Attachment.attachment_type == 'Video' %}
        <i data-toggle="tooltip" data-placement="top" title="Video" class="fas fa-play-circle" style="color: #ff0000;"></i>
        {% elif Attachment.attachment_type == 'Image' %}
        <i data-toggle="tooltip" data-placement="top" title="Image" class="far fa-image" style="color: #ff0000;"></i>
        {% elif Attachment.attachment_type == 'PDF' %}
        <i data-toggle="tooltip" data-placement="top" title="PDF" class="far fa-file-pdf" style="color: #ff0000;"></i>
        {% endif %}
        {% if Attachment.isBookmarked %}&nbsp;<div class="d-inline-block"><a href="{% url 'bookmark-view' Attachment.isBookmarked.id %}" data-toggle="tooltip" data-placement="top" title="Bookmarked" class="far fa-bookmark" style="color: #3d7deb;"></a></div>{% endif %}
      </td>

      <td>{{ Attachment.title }}</td>
      <td>{{ Attachment.patient.baby_name }}</td>

      <td>{{ Attachment.description }}</td>
      <td><div style="cursor: pointer;"><i data-toggle="tooltip" data-placement="top" title="Uploaded on : {{ Attachment.uploaded_on }} by : {{ Attachment.uploaded_by.username }}, {% if Attachment.last_edit_by %} last edited on {{ Attachment.last_edit_on }} by {{ Attachment.last_edit_by.username }}{% endif %}" class="fas fa-info-circle" style="color: #3d7deb;"></i></div></td>
      
      <td><div style="cursor: pointer;" class=" btn-group" role="group">
          <a id="btnGroupDrop1" class="fas fa-walking" data-toggle="dropdown" aria-haspopup="false" aria-expanded="true"> Action</a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="btnGroupDrop1">

            {% if Attachment.attachment_type == 'Image' %}
            <a class="dropdown-item" href="{% url 'attachment-view' Attachment.id %}"><i class="fas fa-eye"></i> View Attached Image</a>
            {% elif Attachment.attachment_type == 'PDF' %}
            <a class="dropdown-item" href="{% url 'attachment-view' Attachment.id %}"><i class="fas fa-eye"></i> Read Attached PDF</a>
            {% elif Attachment.attachment_type == 'Video' %}
            <a class="dropdown-item" href="{% url 'attachment-view' Attachment.id %}"><i class="fas fa-eye"></i> Play Attached Video</a>
            {% else %}
            {% endif %}

            <div><hr></div>
            <a class="dropdown-item" href="{% url 'attachment-edit' Attachment.id %}"><i class="fas fa-pencil-alt"></i> Edit</a>
            <a class="dropdown-item" href="{% url 'attachment-delete-confirm' Attachment.id %}"><i class="far fa-trash-alt"></i> Delete</a>
            <a class="dropdown-item" href="{% url 'view-patient' Attachment.patient.id %}"><i class="fas fas fa-eye"></i> View Patient</a>
            <a class="dropdown-item" href="{% url 'attachment-manager-patient' Attachment.patient.id %}"><i class="fas fas fa-eye"></i> View Other Attachments</a>
            <a class="dropdown-item" href="{% url 'user-view-by-username' Attachment.uploaded_by.username %}"><i class="fas fas fa-eye"></i> View Uploaded user</a>
            <div><hr></div>
            {% if Attachment.isBookmarked %}
            <a class="dropdown-item" href="{% url 'bookmark-view' Attachment.isBookmarked.id %}"><i class="fas fas fa-eye"></i> View Bookmark</a>
            {% else %}
            <a class="dropdown-item" href="{% url 'bookmark-add' Attachment.id 'Attachment' %}"><i class="fas fa-circle fa-plus"></i> Add Bookmark</a>
            {% endif %}

          </div>
        </div>
      </div>
    </td>

    </tr>
    {% endfor %}
    </tbody>

    </table>
    </div>

    <div class="card text-center d-flex align-items-center justify-content-center">
      <div class="card-body">

        <nav aria-label="Page navigation example">
          <ul class="pagination justify-content-center">
          <li>
            {% if attachment_page_obj.has_previous %}
              <li class="page-item"> <a class="page-link" href="?page=1" tabindex="-1">&laquo; First</a>
              <li class="page-item"> <a class="page-link" href="?page={{ attachment_page_obj.previous_page_number }}" tabindex="-1">Previous</a></li>
            {% else %}
              <li class="page-item disabled"> <a class="page-link" href="#" tabindex="-1">&laquo; First</a>
              <li class="page-item disabled"> <a class="page-link" href="#" tabindex="-1">Previous</a> </li>
            {% endif %}
          
            <li class="page-item"><a class="page-link">Page {{ attachment_page_obj.number }} of {{ attachment_page_obj.paginator.num_pages }}</a></li>
          
            {% if attachment_page_obj.has_next %}
              <li class="page-item"><a class="page-link" href="?page={{ attachment_page_obj.next_page_number }}">Next</a></li>
              <li class="page-item"><a class="page-link" href="?page={{ attachment_page_obj.paginator.num_pages }}">Last &raquo;</a></li>
            {% else %}
              <li class="page-item disabled"><a class="page-link" href="#">Next</a></li>
              <li class="page-item disabled"><a class="page-link" href="#">Last &raquo;</a></li>
            {% endif %}
          
          </li>
          </ul>
        </nav>

      </div>
    </div>

{% else %} 
<div class="alert alert-secondary" role="alert">No records found</div>
{% endif %}

</div>
{% endblock main_content %}
